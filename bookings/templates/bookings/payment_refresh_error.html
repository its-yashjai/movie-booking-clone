{% extends 'base/base.html' %}

{% block title %}Payment Cancelled - Booking System{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card border-0 shadow-lg">
                <div class="card-body p-5 text-center">
                    <!-- Error Icon -->
                    <div class="mb-4">
                        <i class="fas fa-exclamation-triangle text-warning" style="font-size: 5rem;"></i>
                    </div>
                    
                    <!-- Error Message -->
                    <h2 class="h3 text-danger mb-3">Payment Page Refreshed</h2>
                    <p class="lead text-muted mb-4">
                        We detected that you refreshed the payment page or clicked the back button.
                    </p>
                    
                    <!-- Explanation -->
                    <div class="alert alert-info text-start mb-4">
                        <h5 class="alert-heading">
                            <i class="fas fa-info-circle me-2"></i>What happened?
                        </h5>
                        <p class="mb-2">
                            When you refresh or navigate away from the payment page, we assume you don't want to proceed with this booking.
                        </p>
                        <p class="mb-0">
                            <strong>Your seats have been released</strong> and are now available for other users to book.
                        </p>
                    </div>
                    
                    <!-- Booking Details -->
                    <div class="card bg-light mb-4">
                        <div class="card-body">
                            <h5 class="card-title text-dark mb-3">Previous Booking Details</h5>
                            <div class="row text-start">
                                <div class="col-md-6 mb-2">
                                    <small class="text-muted d-block">Movie</small>
                                    <strong>{{ movie.title }}</strong>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <small class="text-muted d-block">Theater</small>
                                    <strong>{{ showtime.screen.theater.name }}</strong>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <small class="text-muted d-block">Date & Time</small>
                                    <strong>{{ showtime.get_formatted_date }} at {{ showtime.get_formatted_time }}</strong>
                                </div>
                                <div class="col-md-6 mb-2">
                                    <small class="text-muted d-block">Selected Seats</small>
                                    <strong>
                                        {% for seat in booking.seats %}
                                            <span class="badge bg-secondary">{{ seat }}</span>
                                        {% endfor %}
                                    </strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status -->
                    {% if seats_released %}
                    <div class="alert alert-success mb-4">
                        <i class="fas fa-check-circle me-2"></i>
                        Seats have been successfully released and are now available for booking.
                    </div>
                    {% else %}
                    <div class="alert alert-warning mb-4">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        There was an issue releasing your seats. They will be automatically released within 12 minutes.
                    </div>
                    {% endif %}
                    
                    <!-- Actions -->
                    <div class="d-grid gap-3">
                        <a href="{% url 'select_seats' showtime.id %}" class="btn btn-primary btn-lg">
                            <i class="fas fa-redo me-2"></i>Select Seats Again & Create New Booking
                        </a>
                        <a href="{% url 'movie_detail' movie.slug %}" class="btn btn-outline-secondary">
                            <i class="fas fa-film me-2"></i>View Movie Details
                        </a>
                        <a href="{% url 'my_bookings' %}" class="btn btn-outline-secondary">
                            <i class="fas fa-list me-2"></i>View My Bookings
                        </a>
                    </div>
                    
                    <!-- Tips -->
                    <div class="mt-5 pt-4 border-top">
                        <h6 class="text-muted mb-3">
                            <i class="fas fa-lightbulb me-2"></i>Tips for successful booking:
                        </h6>
                        <ul class="list-unstyled text-muted small text-start">
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Complete the payment within 12 minutes after seat selection
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Do not refresh or close the payment window
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                If you face any issues, start a new booking instead of refreshing
                            </li>
                            <li class="mb-2">
                                <i class="fas fa-check text-success me-2"></i>
                                Ensure you have a stable internet connection during payment
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
